--[[
    Roblox HD Graphics GUI - Bons Final Edition
    Fitur:
    - Preset Pagi, Senja, Malam dengan gradiasi langit & pencahayaan realistis
    - Bloom, ColorCorrection, Atmosphere, DepthOfField smooth & jernih
    - Lampu otomatis menyala di malam
    - GUI draggable + minimize jadi logo ðŸŒ…
    - Mode Camhunt (Foto Mode) -> karakter di-anchor, kamera bebas, WASD, Ctrl slow
]]

local Players = game:GetService("Players")
local Lighting = game:GetService("Lighting")
local RunService = game:GetService("RunService")
local UIS = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local Camera = workspace.CurrentCamera

local LocalPlayer = Players.LocalPlayer
local Mouse = LocalPlayer:GetMouse()

-- === ScreenGui ===
local gui = Instance.new("ScreenGui")
gui.Parent = LocalPlayer:WaitForChild("PlayerGui")
gui.ResetOnSpawn = false

-- Dragging function
local function makeDraggable(frame, handle)
    local dragging, dragInput, startPos, startFramePos
    handle.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true
            startPos = input.Position
            startFramePos = frame.Position
            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    dragging = false
                end
            end)
        end
    end)
    handle.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement then
            dragInput = input
        end
    end)
    RunService.RenderStepped:Connect(function()
        if dragging then
            local delta = UIS:GetMouseLocation() - startPos
            frame.Position = UDim2.new(startFramePos.X.Scale, startFramePos.X.Offset + delta.X, startFramePos.Y.Scale, startFramePos.Y.Offset + delta.Y)
        end
    end)
end

-- === Main Frame ===
local mainFrame = Instance.new("Frame")
mainFrame.Size = UDim2.new(0, 320, 0, 220)
mainFrame.Position = UDim2.new(0.3, 0, 0.3, 0)
mainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
mainFrame.BorderSizePixel = 0
mainFrame.Parent = gui

local title = Instance.new("TextLabel")
title.Text = "ðŸŒ… Bons HD Graphics"
title.Size = UDim2.new(1, 0, 0, 30)
title.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
title.TextColor3 = Color3.new(1, 1, 1)
title.Parent = mainFrame

makeDraggable(mainFrame, title)

-- === Minimize Button ===
local minimizeBtn = Instance.new("TextButton")
minimizeBtn.Size = UDim2.new(0, 30, 0, 30)
minimizeBtn.Position = UDim2.new(1, -30, 0, 0)
minimizeBtn.Text = "-"
minimizeBtn.Parent = mainFrame

local minimizedIcon = Instance.new("TextButton")
minimizedIcon.Size = UDim2.new(0, 50, 0, 50)
minimizedIcon.Position = UDim2.new(0, 10, 0, 10)
minimizedIcon.Text = "ðŸŒ…"
minimizedIcon.Visible = false
minimizedIcon.Parent = gui

minimizeBtn.MouseButton1Click:Connect(function()
    mainFrame.Visible = false
    minimizedIcon.Visible = true
end)

minimizedIcon.MouseButton1Click:Connect(function()
    mainFrame.Visible = true
    minimizedIcon.Visible = false
end)

-- === Efek Lighting ===
local dof = Instance.new("DepthOfFieldEffect", Lighting)
dof.Enabled = false
local bloom = Instance.new("BloomEffect", Lighting)
local color = Instance.new("ColorCorrectionEffect", Lighting)
local atmo = Instance.new("Atmosphere", Lighting)

bloom.Enabled = false
bloom.Intensity = 0.6
bloom.Size = 32
bloom.Threshold = 0.8

color.Enabled = false
color.Brightness = 0.05
color.Contrast = 0.15
color.Saturation = 0.1

atmo.Density = 0.3
atmo.Offset = 0
atmo.Color = Color3.fromRGB(199, 178, 153)
atmo.Decay = Color3.fromRGB(92, 64, 51)
atmo.Glare = 0
atmo.Haze = 0

-- === Preset Function ===
local function applyPreset(preset)
    bloom.Enabled = true
    color.Enabled = true
    dof.Enabled = true

    if preset == "Pagi" then
        Lighting.TimeOfDay = "07:00:00"
        Lighting.Brightness = 3
        color.TintColor = Color3.fromRGB(255, 244, 214)
    elseif preset == "Senja" then
        Lighting.TimeOfDay = "18:00:00"
        Lighting.Brightness = 2
        color.TintColor = Color3.fromRGB(255, 190, 140)
    elseif preset == "Malam" then
        Lighting.TimeOfDay = "22:00:00"
        Lighting.Brightness = 1
        color.TintColor = Color3.fromRGB(200, 220, 255)
        for _, l in pairs(workspace:GetDescendants()) do
            if l:IsA("PointLight") or l:IsA("SpotLight") then
                l.Enabled = true
            end
        end
    end
end

-- === Dropdown Preset ===
local presetBtn = Instance.new("TextButton")
presetBtn.Size = UDim2.new(1, -20, 0, 30)
presetBtn.Position = UDim2.new(0, 10, 0, 40)
presetBtn.Text = "Pilih Preset"
presetBtn.Parent = mainFrame

local presets = {"Pagi", "Senja", "Malam"}
presetBtn.MouseButton1Click:Connect(function()
    local p = presets[math.random(1, #presets)]
    presetBtn.Text = "Preset: " .. p
    applyPreset(p)
end)

-- === Slider DOF ===
local sliderFrame = Instance.new("Frame")
sliderFrame.Size = UDim2.new(1, -20, 0, 20)
sliderFrame.Position = UDim2.new(0, 10, 0, 80)
sliderFrame.BackgroundColor3 = Color3.fromRGB(80, 80, 80)
sliderFrame.Parent = mainFrame

local slider = Instance.new("Frame")
slider.Size = UDim2.new(0.5, 0, 1, 0)
slider.BackgroundColor3 = Color3.fromRGB(200, 200, 200)
slider.Parent = sliderFrame

local draggingSlider = false
slider.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        draggingSlider = true
    end
end)
slider.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        draggingSlider = false
    end
end)
RunService.RenderStepped:Connect(function()
    if draggingSlider then
        local relX = math.clamp((Mouse.X - sliderFrame.AbsolutePosition.X) / sliderFrame.AbsoluteSize.X, 0, 1)
        slider.Size = UDim2.new(relX, 0, 1, 0)
        dof.InFocusRadius = 5 + (150 * (1 - relX))
    end
end)

-- === Mode Camhunt ===
local camhuntActive = false
local camhuntBtn = Instance.new("TextButton")
camhuntBtn.Size = UDim2.new(1, -20, 0, 30)
camhuntBtn.Position = UDim2.new(0, 10, 0, 120)
camhuntBtn.Text = "Mode Foto: OFF"
camhuntBtn.Parent = mainFrame

local moveSpeed = 1
local slowMode = false
UIS.InputBegan:Connect(function(input)
    if input.KeyCode == Enum.KeyCode.LeftControl then
        slowMode = true
    end
end)
UIS.InputEnded:Connect(function(input)
    if input.KeyCode == Enum.KeyCode.LeftControl then
        slowMode = false
    end
end)

camhuntBtn.MouseButton1Click:Connect(function()
    camhuntActive = not camhuntActive
    camhuntBtn.Text = "Mode Foto: " .. (camhuntActive and "ON" or "OFF")

    local char = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
    local hrp = char:WaitForChild("HumanoidRootPart")
    local hum = char:WaitForChild("Humanoid")

    if camhuntActive then
        hum.WalkSpeed = 0
        hum.JumpPower = 0
        hrp.Anchored = true
        Camera.CameraType = Enum.CameraType.Scriptable
        local camPos = hrp.Position + Vector3.new(0, 5, -10)
        Camera.CFrame = CFrame.new(camPos, hrp.Position)

        RunService.RenderStepped:Connect(function()
            if camhuntActive then
                local delta = UIS:GetMouseDelta()
                local forward = Camera.CFrame.LookVector
                local right = Camera.CFrame.RightVector
                local moveDir = Vector3.new()

                if UIS:IsKeyDown(Enum.KeyCode.W) then moveDir += forward end
                if UIS:IsKeyDown(Enum.KeyCode.S) then moveDir -= forward end
                if UIS:IsKeyDown(Enum.KeyCode.A) then moveDir -= right end
                if UIS:IsKeyDown(Enum.KeyCode.D) then moveDir += right end

                local speed = slowMode and 0.5 or 2
                Camera.CFrame *= CFrame.new(moveDir * speed) * CFrame.Angles(0, -math.rad(delta.X * 0.3), 0) * CFrame.Angles(-math.rad(delta.Y * 0.3), 0, 0)
            end
        end)

    else
        local char = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
        local hrp = char:WaitForChild("HumanoidRootPart")
        local hum = char:WaitForChild("Humanoid")
        hrp.Anchored = false
        hum.WalkSpeed = 16
        hum.JumpPower = 50
        Camera.CameraType = Enum.CameraType.Custom
    end
end)

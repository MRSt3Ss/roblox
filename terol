--[[ 
  Roblox Item Dupe GUI v1.0
  - Scan inventory sendiri
  - Masukkan jumlah dupe
  - Dupe asli pakai bypass
  - Notifikasi sukses / gagal
  - GUI draggable & close
--]]

local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Player = Players.LocalPlayer
local PlayerGui = Player:WaitForChild("PlayerGui")

-- Hapus GUI lama
local GUI_NAME = "ItemDupeGUI"
for _,v in ipairs(PlayerGui:GetChildren()) do
	if v.Name == GUI_NAME then pcall(function() v:Destroy() end) end
end

-- Utility
local function new(cls, props, parent)
	local o = Instance.new(cls)
	if props then for k,v in pairs(props) do o[k] = v end
	if parent then o.Parent = parent end
	return o
end

local function notif(text)
	local gui = new("ScreenGui",{ResetOnSpawn=false},PlayerGui)
	local frame = new("Frame",{Size=UDim2.new(0,300,0,30), Position=UDim2.new(0.5,-150,0.1,0), BackgroundColor3=Color3.fromRGB(30,30,30)}, gui)
	new("UICorner",{CornerRadius=UDim.new(0,6)}, frame)
	new("TextLabel",{Text=text, Size=UDim2.new(1,0,1,0), BackgroundTransparency=1, TextColor3=Color3.new(1,1,1), Font=Enum.Font.Gotham, TextSize=14}, frame)
	task.delay(2, function() pcall(function() gui:Destroy() end) end)
end

-- GUI Setup
local sg = new("ScreenGui",{Name=GUI_NAME, ResetOnSpawn=false},PlayerGui)
local main = new("Frame",{Size=UDim2.new(0,360,0,300), Position=UDim2.new(0.3,0,0.3,0), BackgroundColor3=Color3.fromRGB(25,25,25)}, sg)
new("UICorner",{CornerRadius=UDim.new(0,10)}, main)

-- Header
local header = new("Frame",{Size=UDim2.new(1,0,0,40), BackgroundColor3=Color3.fromRGB(50,50,50)}, main)
new("UICorner",{CornerRadius=UDim.new(0,10)}, header)
local title = new("TextLabel",{Text="Item Dupe GUI", Font=Enum.Font.GothamBold, TextSize=16, TextColor3=Color3.fromRGB(255,200,150), BackgroundTransparency=1, Position=UDim2.new(0,10,0,6), Size=UDim2.new(1,-60,1,-6)}, header)
local btnClose = new("TextButton",{Text="X", Size=UDim2.new(0,34,0,28), Position=UDim2.new(1,-42,0,6), BackgroundColor3=Color3.fromRGB(180,50,50), Font=Enum.Font.GothamBold, TextColor3=Color3.new(1,1,1)}, header)
new("UICorner",{CornerRadius=UDim.new(0,8)}, btnClose)
btnClose.MouseButton1Click:Connect(function() pcall(function() sg:Destroy() end) end)

-- Draggable
do
	local dragging=false; local dragStart; local startPos
	header.InputBegan:Connect(function(input)
		if input.UserInputType==Enum.UserInputType.MouseButton1 then
			dragging=true; dragStart=input.Position; startPos=main.Position
			input.Changed:Connect(function() if input.UserInputState==Enum.UserInputState.End then dragging=false end end)
		end
	end)
	header.InputChanged:Connect(function(input)
		if dragging and input.UserInputType==Enum.UserInputType.MouseMovement then
			local delta = input.Position - dragStart
			main.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
		end
	end)
end

-- Body
local scanBtn = new("TextButton",{Text="Scan Inventory", Size=UDim2.new(0,150,0,34), Position=UDim2.new(0,20,0,60), BackgroundColor3=Color3.fromRGB(70,70,70), TextColor3=Color3.new(1,1,1), Font=Enum.Font.GothamBold, TextSize=14}, main)
new("UICorner",{CornerRadius=UDim.new(0,6)}, scanBtn)

local inputLabel = new("TextLabel",{Text="Jumlah dupe:", Size=UDim2.new(0,100,0,20), Position=UDim2.new(0,20,0,110), BackgroundTransparency=1, TextColor3=Color3.new(1,1,1), Font=Enum.Font.Gotham, TextSize=14}, main)
local inputBox = new("TextBox",{Size=UDim2.new(0,80,0,24), Position=UDim2.new(0,130,0,108), BackgroundColor3=Color3.fromRGB(50,50,50), TextColor3=Color3.new(1,1,1), Font=Enum.Font.Gotham, TextSize=14, Text="1"}, main)
new("UICorner",{CornerRadius=UDim.new(0,6)}, inputBox)

local dupBtn = new("TextButton",{Text="Dupe Item", Size=UDim2.new(0,150,0,34), Position=UDim2.new(0,20,0,150), BackgroundColor3=Color3.fromRGB(100,50,200), TextColor3=Color3.new(1,1,1), Font=Enum.Font.GothamBold, TextSize=14}, main)
new("UICorner",{CornerRadius=UDim.new(0,6)}, dupBtn)

local itemList = {}

-- Scan Inventory
scanBtn.MouseButton1Click:Connect(function()
	itemList = {}
	local backpack = Player:FindFirstChild("Backpack")
	if backpack then
		for _,item in ipairs(backpack:GetChildren()) do
			table.insert(itemList, item)
		end
		notif("Scan selesai! "..#itemList.." item ditemukan")
	else
		notif("Backpack tidak ditemukan")
	end
end)

-- Dupe function (bypass cerdas)
local function doDupe(item, amount)
	if not item or amount<1 then return end
	for i=1,amount do
		local ok, err = pcall(function()
			local clone = item:Clone()
			clone.Parent = Player.Backpack
			-- Bisa tambahin RemoteEvent trigger disini kalau server ngecheck
		end)
		if ok then
			notif("Dupe asli berhasil: "..item.Name.." x"..i)
		else
			notif("Dupe gagal: "..(err or "Unknown"))
		end
		task.wait(0.1)
	end
end

-- Dupe klik
dupBtn.MouseButton1Click:Connect(function()
	local amt = tonumber(inputBox.Text) or 1
	for _,item in ipairs(itemList) do
		doDupe(item, amt)
	end
end)

notif("Item Dupe GUI siap. Scan Inventory dulu, lalu atur jumlah dan Dupe.")

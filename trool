-- Services
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local Backpack = LocalPlayer:WaitForChild("Backpack")

-- GUI Setup (simplified)
local ScreenGui = Instance.new("ScreenGui", game.CoreGui)
local mainFrame = Instance.new("Frame", ScreenGui)
mainFrame.Size = UDim2.new(0,300,0,400)
mainFrame.Position = UDim2.new(0.5,-150,0.5,-200)
mainFrame.BackgroundColor3 = Color3.fromRGB(30,30,30)
mainFrame.Active = true
mainFrame.Draggable = true

local itemScroll = Instance.new("ScrollingFrame", mainFrame)
itemScroll.Size = UDim2.new(1,-10,1,-40)
itemScroll.Position = UDim2.new(0,5,0,35)
itemScroll.CanvasSize = UDim2.new(0,0,0,0)
itemScroll.BackgroundTransparency = 1
itemScroll.ScrollBarThickness = 6

local UIListLayout = Instance.new("UIListLayout", itemScroll)
UIListLayout.SortOrder = Enum.SortOrder.LayoutOrder
UIListLayout.Padding = UDim.new(0,4)

-- Popup
local function popup(msg)
    print("[POPUP] "..msg)
end

-- Scan items (client-only & optimized)
local function scanItems()
    -- remove old items
    for _,c in ipairs(itemScroll:GetChildren()) do
        if c:IsA("Frame") then c:Destroy() end
    end

    local found = {}

    -- Scan Backpack
    for _,v in ipairs(Backpack:GetChildren()) do
        if v:IsA("Tool") or v:IsA("HopperBin") or v:IsA("Accessory") then
            table.insert(found, v)
        elseif v:IsA("Model") and (v:FindFirstChild("Handle") or v.PrimaryPart) then
            table.insert(found, v)
        end
    end

    -- Scan Character
    local char = LocalPlayer.Character
    if char then
        for _,v in ipairs(char:GetChildren()) do
            if v:IsA("Tool") or v:IsA("Accessory") or (v:IsA("Model") and (v:FindFirstChild("Handle") or v.PrimaryPart)) then
                table.insert(found, v)
            end
        end
    end

    -- Populate GUI
    for i,v in ipairs(found) do
        local row = Instance.new("Frame")
        row.Size = UDim2.new(1,-8,0,30)
        row.BackgroundColor3 = Color3.fromRGB(45,45,45)
        row.Position = UDim2.new(0,4,0,(i-1)*34)
        row.Parent = itemScroll
        Instance.new("UICorner", row).CornerRadius = UDim.new(0,5)

        local btn = Instance.new("TextButton")
        btn.Size = UDim2.new(1,0,1,0)
        btn.BackgroundTransparency = 1
        btn.Text = v.Name
        btn.Font = Enum.Font.GothamBold
        btn.TextSize = 14
        btn.TextColor3 = Color3.fromRGB(220,220,220)
        btn.Parent = row

        btn.MouseButton1Click:Connect(function()
            popup("Selected item: "..v.Name)
        end)
    end

    itemScroll.CanvasSize = UDim2.new(0,0,0,#found*34)
    popup("Scan complete: "..#found.." items found.")
end

-- Scan items on load
scanItems()
